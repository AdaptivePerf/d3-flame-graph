!function(){"use strict";function n(){function t(t){return t.data.n||t.data.name}function n(t){return t.c||t.children}function r(t){return t.v||t.value}function i(t){var n=document.getElementById("details");n&&(n.innerHTML=t)}function a(t){var n=0,e=1,r=0,i=10,a=6;if(t){for(var u=0;u<t.length&&!(u>a);u++)n+=e*(t.charCodeAt(u)%i),r+=e*(i-1),e*=.7;r>0&&(n/=r)}return n}function u(t){var n=0;if(t){var e=t.split("`");e.length>1&&(t=e[e.length-1]),t=t.split("(")[0],n=a(t)}var r=200+Math.round(55*n),i=0+Math.round(230*(1-n)),u=0+Math.round(55*(1-n));return"rgb("+r+","+i+","+u+")"}function o(t){t.data.original||(t.data.original=r(t)),t.data.v=0,t.data.value&&delete t.data.value,n(t)&&n(t).forEach(o)}function f(t){t.data.fade=!1,t.data.original&&(t.data.v=t.data.original),n(t)&&n(t).forEach(f)}function c(t){var n=[];if(t.parent){var e=t.parent.children.indexOf(t);n=t.parent.children.slice(0),n.splice(e,1)}return n}function l(t){var n=c(t);n.forEach(function(t){o(t)}),t.parent&&l(t.parent)}function d(t){t.parent&&(t.parent.data.fade=!0,d(t.parent))}function h(t){B.hide(t),l(t),f(t),d(t),m(),"function"==typeof H&&H(t)}function s(e,r){function i(e){var r=t(e);n(e)&&n(e).forEach(function(t){i(t)}),r.match(a)?(e.highlight=!0,u.push(e)):e.highlight=!1}var a=new RegExp(r),u=[];return i(e),u}function g(t){t.highlight=!1,n(t)&&n(t).forEach(function(t){g(t)})}function p(n,r){return"function"==typeof q?q(n,r):q?e.ascending(t(n),t(r)):void 0}function v(t){var n=t.descendants();if(S>0){var e=A/(t.x1-t.x0);n=n.filter(function(t){return(t.x1-t.x0)*e>S})}return n}function m(){T.each(function(a){function u(t){return(t.x1-t.x0)*c}var o=e.scaleLinear().range([0,A]),f=e.scaleLinear().range([0,O]);q&&a.sort(p),a.sum(function(t){if(t.fade||!r(t))return 0;var e=r(t);if(n(t))for(var i=n(t),a=0;a<i.length;a++)e-=i[a].value;return e}),G(a);var c=A/(a.x1-a.x0),l=v(a),d=e.select(this).select("svg").selectAll("g").data(l,function(t){return t.id});d.transition().duration(C).ease(L).attr("transform",function(t){return"translate("+o(t.x0)+","+(z?f(t.depth):M-f(t.depth)-O)+")"}),d.select("rect").attr("width",u);var s=d.enter().append("svg:g").attr("transform",function(t){return"translate("+o(t.x0)+","+(z?f(t.depth):M-f(t.depth)-O)+")"});s.append("svg:rect").transition().delay(C/2).attr("width",u),j||s.append("svg:title"),s.append("foreignObject").append("xhtml:div"),d=e.select(this).select("svg").selectAll("g").data(l,function(t){return t.id}),d.attr("width",u).attr("height",function(t){return O}).attr("name",function(n){return t(n)}).attr("class",function(t){return t.data.fade?"frame fade":"frame"}),d.select("rect").attr("height",function(t){return O}).attr("fill",function(t){return F(t)}),j||d.select("title").text(D),d.select("foreignObject").attr("width",u).attr("height",function(t){return O}).select("div").attr("class","label").style("display",function(t){return u(t)<35?"none":"block"}).transition().delay(C).text(t),d.on("click",h),d.exit().remove(),d.on("mouseover",function(t){j&&B.show(t),i(D(t))}).on("mouseout",function(t){j&&B.hide(t),i("")})})}function y(n,e){e.forEach(function(e){var r=n.find(function(n){return t(n)===t(e)});r?(r.original?r.original+=e.value:r.value+=e.value,e.children&&(r.children||(r.children=[]),y(r.children,e.children))):n.push(e)})}function x(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function w(t){t.id=x()+"-"+x()+"--"+x()+"-"+x();for(var n=t.c||t.children||[],e=0;e<n.length;e++)w(n[e])}function E(t){var r=e.hierarchy(t.datum(),function(t){return n(t)});return w(r),T=t.datum(r),arguments.length?(M||(M=(r.height+2)*O),T.each(function(t){b||(b=e.select(this).append("svg:svg").attr("width",A).attr("height",M).attr("class","partition d3-flame-graph").call(B),b.append("svg:text").attr("class","title").attr("text-anchor","middle").attr("y","25").attr("x",A/2).attr("fill","#808080").text(k))}),void m()):E}var b,A=960,M=null,O=18,T=null,j=!0,k="",C=750,L=e.easeCubic,q=!1,z=!1,H=null,S=0,B=e.tip().direction("s").offset([8,0]).attr("class","d3-flame-graph-tip").html(function(t){return D(t)}),D=function(n){return t(n)+" ("+e.format(".3f")(100*(n.x1-n.x0),3)+"%, "+r(n)+" samples)"},F=function(n){return n.highlight?"#E600E6":u(t(n))},G=e.partition();return E.height=function(t){return arguments.length?(M=t,E):M},E.width=function(t){return arguments.length?(A=t,E):A},E.cellHeight=function(t){return arguments.length?(O=t,E):O},E.tooltip=function(t){return arguments.length?("function"==typeof t&&(B=t),j=!!t,E):j},E.title=function(t){return arguments.length?(k=t,E):k},E.transitionDuration=function(t){return arguments.length?(C=t,E):C},E.transitionEase=function(t){return arguments.length?(L=t,E):L},E.sort=function(t){return arguments.length?(q=t,E):q},E.reversed=function(t){return arguments.length?(z=t,E):z},E.label=function(t){return arguments.length?(D=t,E):D},E.search=function(t){var n=[];return T.each(function(e){n=s(e,t),m()}),n},E.clear=function(){T.each(function(t){g(t),m()})},E.zoomTo=function(t){h(t)},E.resetZoom=function(){T.each(function(t){h(t)})},E.onClick=function(t){return arguments.length?(H=t,E):H},E.merge=function(t){var r;T.each(function(i){y([i.data],[t]),r=e.hierarchy(i.data,function(t){return n(t)})}),T=T.datum(r),m()},E.color=function(t){return arguments.length?(F=t,E):F},E.minFrameSize=function(t){return arguments.length?(S=t,E):S},E}if(Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),e=n.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;e>i;){var a=n[i];if(t.call(r,a,i,n))return a;i++}return void 0}}),Array.prototype.filter||(Array.prototype.filter=function(n,e){if("function"!=typeof n||!this)throw new TypeError;var r=this.length>>>0,i=new Array(r),a=0,u=-1;if(void 0===e)for(;++u!==r;)if(u in this)if(n(t[u],u,t))i[a++]=t[u];else for(;++u!==r;)u in this&&n.call(e,t[u],u,t)&&(i[a++]=t[u]);return i.length=a,i}),"undefined"!=typeof module&&"undefined"!=typeof exports&&"undefined"==typeof e)var e=require("d3");"undefined"!=typeof module&&"undefined"!=typeof exports&&"undefined"==typeof e.tip&&(e.tip=require("d3-tip")),e.flameGraph=n,"undefined"!=typeof module&&"undefined"!=typeof exports&&(module.exports=n)}();